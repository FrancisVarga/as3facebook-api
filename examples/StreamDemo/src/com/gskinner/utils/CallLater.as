/*** Visit www.gskinner.com/blog for documentation, updates and more free code.** Copyright (c) 2009 Grant Skinner* * Permission is hereby granted, free of charge, to any person* obtaining a copy of this software and associated documentation* files (the "Software"), to deal in the Software without* restriction, including without limitation the rights to use,* copy, modify, merge, publish, distribute, sublicense, and/or sell* copies of the Software, and to permit persons to whom the* Software is furnished to do so, subject to the following* conditions:* * The above copyright notice and this permission notice shall be* included in all copies or substantial portions of the Software.* * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR* OTHER DEALINGS IN THE SOFTWARE.**/package com.gskinner.utils {		import flash.display.Sprite;	import flash.events.Event;	import flash.utils.Dictionary;		public class CallLater extends Sprite {				protected static var _instance:CallLater;				protected var callLaterHash:Dictionary;			// Initialization:		public function CallLater() {			//wdg:: DO NOT make weakKeys == true; GC will clear the function otherwise.			callLaterHash = new Dictionary();		}			// Public Methods:		public static function call(p_function:Function, p_frameDelay:uint = 1, p_params:Array = null):void {			getInstance().call(p_function, p_frameDelay, p_params);		}				public function call(p_function:Function, p_frameDelay:uint, p_params:Array):void {			callLaterHash[p_function] = new CallLaterData(p_frameDelay, p_params);			if (hasEventListener(Event.ENTER_FRAME) == false) { this.addEventListener(Event.ENTER_FRAME, onFrame); }		}				// Protected Methods:		protected function onFrame(p_event:Event):void {			var hasRun:Boolean = false;			for (var func:Object in callLaterHash) {				hasRun = true;				var obj:CallLaterData = callLaterHash[func] as CallLaterData;				if (--obj.delay == 0) {					if (obj.params != null) {						(func as Function).apply(null, obj.params);					} else {						func();					}					delete callLaterHash[func];				}			}			if (hasRun == false) { removeEventListener(Event.ENTER_FRAME, onFrame); }		}				protected static function getInstance():CallLater {			if (_instance == null) { _instance = new CallLater(); }			return _instance;		}	}}class CallLaterData  {		public var delay:int;	public var params:Array;		public function CallLaterData(p_delay:uint, p_params:Array) {		delay = p_delay;		params = p_params;
	}	
}